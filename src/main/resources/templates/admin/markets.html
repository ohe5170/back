<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가게 관리 - 햇살장터</title>
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="Main-Layout">

        <!-- 사이드바 -->
        <div class="SideBar-Wrapper">
            <div class="SideBar-Header">
                <div class="Header-HeaderContainer">
                    <a href="/admin" class="Header-Logo">
                        <img src="/images/haetsal-jangteo-logo.svg" alt="">
                    </a>
                    <div class="Header-Title">
                        <div class="Header-TitleContent">
                            <p>햇살장터 관리자</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="SideBar-Body">
                <div class="SideBar-MenuContainer">
                    <div class="SideBar-Menu">
                        <a href="/admin" class="SideMenu-Wrapper">
                            <div class="SideMenu-Icon">
                                <svg aria-label="icon" fill="currentColor" height="19.2" role="img" width="19.2"><use href="#home-simple-2-solid"></use></svg>
                            </div>
                            <div class="SideMenu-Content">
                                <p class="SideMenu-Title">홈</p>
                                <p class="SideMenu-SubTitle">관리 목록 한눈에 보기</p>
                            </div>
                        </a>

                        <a href="/admin/users" class="SideMenu-Wrapper">
                            <div class="SideMenu-Icon">
                                <svg aria-label="icon" fill="currentColor" height="19.2" role="img" width="19.2"><use href="#users-group-3-solid"></use></svg>
                            </div>
                            <div class="SideMenu-Content">
                                <p class="SideMenu-Title">회원 관리</p>
                                <p class="SideMenu-SubTitle">회원 조회 및 상태 관리</p>
                            </div>
                        </a>

                        <!-- 가게 관리 (현재 페이지) -->
                        <a href="/admin/markets" class="SideMenu-Wrapper">
                            <div class="SideMenu-Icon current">
                                <svg aria-label="icon" fill="currentColor" height="19.2" role="img" width="19.2"><use href="#building-outline"></use></svg>
                            </div>
                            <div class="SideMenu-Content">
                                <p class="SideMenu-Title">가게 관리</p>
                                <p class="SideMenu-SubTitle">가게 조회 및 입점 신청 관리</p>
                            </div>
                        </a>

                        <a href="/admin/items" class="SideMenu-Wrapper">
                            <div class="SideMenu-Icon">
                                <svg aria-label="icon" fill="currentColor" height="19.2" role="img" width="19.2"><use href="#gift-outline"></use></svg>
                            </div>
                            <div class="SideMenu-Content">
                                <p class="SideMenu-Title">상품 관리</p>
                                <p class="SideMenu-SubTitle">등록된 상품 조회 및 관리</p>
                            </div>
                        </a>

                        <a href="/admin/reports" class="SideMenu-Wrapper">
                            <div class="SideMenu-Icon">
                                <svg aria-label="icon" fill="currentColor" height="19.2" role="img" width="19.2"><use href="#info-circle-outline"></use></svg>
                            </div>
                            <div class="SideMenu-Content">
                                <p class="SideMenu-Title">신고 관리</p>
                                <p class="SideMenu-SubTitle">접수된 신고 조회</p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- 메인 컨텐츠 -->
        <main class="Main-Wrapper">
            <div class="Main-Container">
                <div class="DashBoard-Wrapper">
                    <div class="DashBoard-Container userlist">

                        <!-- 상단 검색바 -->
                        <div class="DashBoard-HeaderContent">
                            <div class="HeaderContent-Wrapper">
                                <div class="HeaderContent-SearchPart">
                                    <div class="SeacrchPart-InputWrapper">
                                        <input id="keyword" type="text" class="SeacrchPart-Input"
                                               th:value="${search != null ? search.keyword : ''}"
                                               placeholder="가게 이름으로 조회" autocomplete="off">
                                    </div>
                                    <!-- 지역 필터 -->
                                    <div class="SeacrchPart-SelectWrapper" id="regionSelectWrapper">
                                        <p class="SeacrchPart-Title">지역</p>
                                        <p class="SeacrchPart-Value" id="regionValue"
                                           th:text="${search != null and search.marketRegion != null and search.marketRegion != '' ? search.marketRegion : '전체'}">전체</p>
                                        <div class="SeacrchPart-SelectOption off" id="regionSelectOption">
                                            <div class="SeacrchPart-SelectHeader">
                                                <div class="SelectHeader-Text">지역</div>
                                            </div>
                                            <div class="SeacrchPart-SelectBody">
                                                <div class="SelectBody-Wrapper">
                                                    <div class="SelectBody-Content">
                                                        <div class="SelectBody-OptionList">
                                                            <div th:each="region : ${regions}"
                                                                 class="SelectBody-OptionValue"
                                                                 th:data-value="${region}">
                                                                <p th:text="${region}">지역</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="SelectBody-Buttons">
                                                        <button type="button" class="SelectBody-AllButton" id="regionAllBtn">전체</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 상태 필터 -->
                                    <div class="SeacrchPart-SelectWrapper" id="stateSelectWrapper">
                                        <p class="SeacrchPart-Title">상태</p>
                                        <p class="SeacrchPart-Value" id="stateValue"
                                           th:text="${search != null and search.marketState != null and search.marketState != '' ? (search.marketState == 'pending' ? '입점 대기' : (search.marketState == 'active' ? '운영 중' : '운영 중단')) : '전체'}">전체</p>
                                        <div class="SeacrchPart-SelectOption off" id="stateSelectOption">
                                            <div class="SeacrchPart-SelectHeader">
                                                <div class="SelectHeader-Text">상태</div>
                                            </div>
                                            <div class="SeacrchPart-SelectBody">
                                                <div class="SelectBody-Wrapper">
                                                    <div class="SelectBody-Content">
                                                        <div class="SelectBody-OptionList">
                                                            <div class="SelectBody-OptionValue" data-value="pending">
                                                                <p>입점 대기</p>
                                                            </div>
                                                            <div class="SelectBody-OptionValue" data-value="active">
                                                                <p>운영 중</p>
                                                            </div>
                                                            <div class="SelectBody-OptionValue" data-value="inactive">
                                                                <p>운영 중단</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="SelectBody-Buttons">
                                                        <button type="button" class="SelectBody-AllButton" id="stateAllBtn">전체</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" class="HeaderContent-SearchButton" id="searchBtn">
                                    <div class="SearchButton-Icon">
                                        <svg aria-label="icon" color="white" fill="currentColor" height="20" role="img" width="20"><use href="#search-outline"></use></svg>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <!-- 가게 목록 -->
                        <div class="DabshBoard-MainContent">
                            <div class="MainContent-ListCount">
                                <div class="MainContent-CountText">
                                    총 <span id="market-total">0</span>개의 가게가 등록되었습니다.
                                </div>
                            </div>

                            <!-- 가게 목록 (JS 동적 렌더링) -->
                            <div id="market-list"></div>

                        </div>

                    </div>
                </div>
            </div>
        </main>

    </div>

    <!-- 가게 수정 모달 -->
    <div name="market-edit" class="EditModal-Layout off">
        <div class="EditModal-Wrapper">
            <div class="EditModal-Container">
                <div class="EditModal-Content">

                    <div class="EditModal-UpperContent">
                        <div class="EditModal-TitleWrapper">
                            <div class="EditModal-Title">가게 정보 수정</div>
                        </div>
                        <div class="EditModal-ButtonWrapper">
                            <button type="button" class="EditModal-CloseButton">
                                <svg aria-label="icon" fill="currentColor" height="18" role="img" width="18"><use href="#close-outline"></use></svg>
                            </button>
                        </div>
                    </div>

                    <div class="EditModal-MiddleContent">
                        <div class="EditModal-MiddleWrapper">

                            <!-- 가게 번호 + 상태 -->
                            <div class="EditModal-DoubleInput">
                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">가게 번호</div>
                                    </div>
                                    <div class="EditModal-InputContent unable">
                                        <input id="market-id" class="EditModal-Input" type="text" value="" disabled>
                                    </div>
                                </div>

                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">상태</div>
                                    </div>
                                    <div class="EditModal-SelectContent disabled">
                                        <div class="EditModal-SelectText">
                                            <input id="market-state" class="EditModal-Input" type="text" value="" disabled>
                                        </div>
                                        <div class="EditModal-SelectButton">
                                            <svg aria-label="icon" fill="currentColor" height="24" role="img" width="24"><use href="#chevron-down-outline"></use></svg>
                                        </div>
                                        <div class="EditModal-SelectList off">
                                            <div class="EditModal-OptionWrapper">
                                                <div class="EditModal-Option" data-value="pending"><p>입점 대기</p></div>
                                                <div class="EditModal-Option" data-value="active"><p>운영 중</p></div>
                                                <div class="EditModal-Option" data-value="inactive"><p>운영 중단</p></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 가게 이름 -->
                            <div class="EditModal-SingleInput">
                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">가게 이름</div>
                                    </div>
                                    <div class="EditModal-InputContent disabled">
                                        <input id="market-name" class="EditModal-Input" type="text" value="" disabled>
                                    </div>
                                </div>
                            </div>

                            <!-- 지역 -->
                            <div class="EditModal-SingleInput">
                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">지역</div>
                                    </div>
                                    <div class="EditModal-InputContent disabled">
                                        <input id="market-region" class="EditModal-Input" type="text" value="" disabled>
                                    </div>
                                </div>
                            </div>

                            <!-- 위치 -->
                            <div class="EditModal-SingleInput">
                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">위치</div>
                                    </div>
                                    <div class="EditModal-InputContent disabled">
                                        <input id="market-location" class="EditModal-Input" type="text" value="" disabled>
                                    </div>
                                </div>
                            </div>

                            <!-- 등록일 + 수정일 -->
                            <div class="EditModal-DoubleInput">
                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">등록일</div>
                                    </div>
                                    <div class="EditModal-InputContent disabled">
                                        <input id="market-createdAt" class="EditModal-Input" type="text" value="" disabled>
                                    </div>
                                </div>
                                <div class="EditModal-InputWrapper">
                                    <div class="EditModal-InputLabel">
                                        <div class="EditModal-InputLabelText">정보 수정일</div>
                                    </div>
                                    <div class="EditModal-InputContent disabled">
                                        <input id="market-updatedAt" class="EditModal-Input" type="text" value="" disabled>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="EditModal-BottomContent">
                        <button class="EditModal-Button Edit" type="button">수정 하기</button>
                        <button class="EditModal-Button Save" type="button" id="market-save-btn">저장 하기</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <svg aria-hidden="true" style="display:none" xmlns="http://www.w3.org/2000/svg">
        <symbol id="home-simple-2-solid" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M10.92 3.81a1.8 1.8 0 0 1 2.16 0l7 5.25c.453.34.72.873.72 1.44V19a1.8 1.8 0 0 1-1.8 1.8h-4a1.8 1.8 0 0 1-1.8-1.8v-3a.2.2 0 0 0-.2-.2h-2a.2.2 0 0 0-.2.2v3A1.8 1.8 0 0 1 9 20.8H5A1.8 1.8 0 0 1 3.2 19v-8.5c0-.567.267-1.1.72-1.44z" fill-rule="evenodd"></path></symbol>
        <symbol id="users-group-3-solid" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M7 8a5 5 0 1 1 10 0A5 5 0 0 1 7 8M5 18a4 4 0 0 1 4-4h6a4 4 0 0 1 4 4v1a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2zm13.998-9.829a6.97 6.97 0 0 1-1.613 4.301l.016.028a6 6 0 0 1 2.02 1.444Q19.704 14 20 14a3 3 0 1 0-1.002-5.829M21 19q-.002.519-.126 1H23a1 1 0 0 0 1-1v-1a3 3 0 0 0-3-3h-.803c.51.883.803 1.907.803 3zM3 18c0-1.093.292-2.117.803-3H3a3 3 0 0 0-3 3v1a1 1 0 0 0 1 1h2.126A4 4 0 0 1 3 19zm1.578-4.056a6 6 0 0 1 2.02-1.444l.017-.028a6.97 6.97 0 0 1-1.613-4.3 3 3 0 1 0-.424 5.773" fill-rule="evenodd"></path></symbol>
        <symbol id="building-outline" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M3.2 5A2.8 2.8 0 0 1 6 2.2h12A2.8 2.8 0 0 1 20.8 5v15.2H22a.8.8 0 0 1 0 1.6H2a.8.8 0 0 1 0-1.6h1.2zm1.6 15.2h14.4V5A1.2 1.2 0 0 0 18 3.8H6A1.2 1.2 0 0 0 4.8 5zM8.2 8a.8.8 0 0 1 .8-.8h1a.8.8 0 1 1 0 1.6H9a.8.8 0 0 1-.8-.8m5 0a.8.8 0 0 1 .8-.8h1a.8.8 0 0 1 0 1.6h-1a.8.8 0 0 1-.8-.8m-5 4a.8.8 0 0 1 .8-.8h1a.8.8 0 1 1 0 1.6H9a.8.8 0 0 1-.8-.8m5 0a.8.8 0 0 1 .8-.8h1a.8.8 0 0 1 0 1.6h-1a.8.8 0 0 1-.8-.8m-5 4a.8.8 0 0 1 .8-.8h1a.8.8 0 1 1 0 1.6H9a.8.8 0 0 1-.8-.8m5 0a.8.8 0 0 1 .8-.8h1a.8.8 0 0 1 0 1.6h-1a.8.8 0 0 1-.8-.8" fill-rule="evenodd"></path></symbol>
        <symbol id="gift-outline" viewBox="0 0 24 24"><path d="M18.2 12.8h-5.4v6.4H18a.2.2 0 0 0 .2-.2zM5.8 19c0 .11.09.2.2.2h5.2v-6.4H5.8zM19.2 9a.2.2 0 0 0-.2-.2h-6.2v2.4H19a.2.2 0 0 0 .2-.2zM4.8 11c0 .11.09.2.2.2h6.2V8.8H5a.2.2 0 0 0-.2.2zm6.4-5c0-.518-.15-.752-.322-.888-.213-.166-.624-.312-1.378-.312s-1.165.146-1.378.312c-.173.136-.322.37-.322.888s.15.752.322.888c.213.166.624.312 1.378.312h1.7zm1.6 1.2h1.7c.754 0 1.165-.146 1.378-.312.173-.136.322-.37.322-.888s-.15-.752-.322-.888c-.213-.166-.624-.312-1.378-.312s-1.165.146-1.378.312c-.173.136-.322.37-.322.888zm5-1.2c0 .43-.068.837-.218 1.2H19A1.8 1.8 0 0 1 20.8 9v2c0 .706-.408 1.316-1 1.61V19a1.8 1.8 0 0 1-1.8 1.8H6A1.8 1.8 0 0 1 4.2 19v-6.39c-.592-.294-1-.904-1-1.61V9A1.8 1.8 0 0 1 5 7.2h1.418A3.1 3.1 0 0 1 6.2 6c0-.862.273-1.628.936-2.147.623-.488 1.46-.653 2.364-.653s1.741.165 2.364.653q.071.056.136.116.064-.061.136-.116c.623-.488 1.46-.653 2.364-.653s1.741.165 2.364.653c.663.519.936 1.285.936 2.147"></path></symbol>
        <symbol id="info-circle-outline" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M12 3.8a8.2 8.2 0 1 0 0 16.4 8.2 8.2 0 0 0 0-16.4M2.2 12c0-5.412 4.388-9.8 9.8-9.8s9.8 4.388 9.8 9.8-4.388 9.8-9.8 9.8-9.8-4.388-9.8-9.8M12 8.19a.8.8 0 0 1 .8.8V9a.8.8 0 0 1-1.6 0v-.01a.8.8 0 0 1 .8-.8m0 3.01a.8.8 0 0 1 .8.8v3a.8.8 0 0 1-1.6 0v-3a.8.8 0 0 1 .8-.8" fill-rule="evenodd"></path></symbol>
        <symbol id="search-outline" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M11 4.8a6.2 6.2 0 1 0 0 12.4 6.2 6.2 0 0 0 0-12.4M3.2 11a7.8 7.8 0 1 1 13.852 4.92l3.514 3.514a.8.8 0 1 1-1.132 1.132l-3.513-3.514A7.77 7.77 0 0 1 11 18.8 7.8 7.8 0 0 1 3.2 11" fill-rule="evenodd"></path></symbol>
        <symbol id="close-outline" viewBox="0 0 24 24"><path d="M17.435 5.435a.8.8 0 1 1 1.13 1.13L13.131 12l5.434 5.435a.8.8 0 1 1-1.13 1.13L12 13.131l-5.435 5.434a.8.8 0 1 1-1.13-1.13L12 10.869z"></path></symbol>
        <symbol id="chevron-down-outline" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M6.434 9.434a.8.8 0 0 1 1.132 0L12 13.87l4.434-4.435a.8.8 0 1 1 1.132 1.132l-5 5a.8.8 0 0 1-1.132 0l-5-5a.8.8 0 0 1 0-1.132" fill-rule="evenodd"></path></symbol>
    </svg>

</body>
<script src="/js/admin/layout.js"></script>
<script>
    // ===== 지역 드롭다운 =====
    const regionWrapper = document.getElementById('regionSelectWrapper');
    const regionOption = document.getElementById('regionSelectOption');
    const regionValueEl = document.getElementById('regionValue');
    let selectedRegion = /*[[${search != null ? search.marketRegion : ''}]]*/ '';

    regionWrapper?.addEventListener('click', (e) => {
        regionOption.classList.toggle('off');
        e.stopPropagation();
    });

    document.querySelectorAll('#regionSelectOption .SelectBody-OptionValue').forEach(opt => {
        opt.addEventListener('click', (e) => {
            selectedRegion = opt.dataset.value;
            regionValueEl.textContent = opt.querySelector('p')?.textContent || opt.dataset.value;
            regionOption.classList.add('off');
            e.stopPropagation();
        });
    });

    document.getElementById('regionAllBtn')?.addEventListener('click', (e) => {
        selectedRegion = '';
        regionValueEl.textContent = '전체';
        regionOption.classList.add('off');
        e.stopPropagation();
    });

    // ===== 상태 드롭다운 =====
    const stateWrapper = document.getElementById('stateSelectWrapper');
    const stateOption = document.getElementById('stateSelectOption');
    const stateValue = document.getElementById('stateValue');
    let selectedState = /*[[${search != null ? search.marketState : ''}]]*/ '';

    stateWrapper?.addEventListener('click', (e) => {
        stateOption.classList.toggle('off');
        e.stopPropagation();
    });

    document.querySelectorAll('#stateSelectOption .SelectBody-OptionValue').forEach(opt => {
        opt.addEventListener('click', (e) => {
            selectedState = opt.dataset.value;
            stateValue.textContent = opt.querySelector('p')?.textContent || opt.dataset.value;
            stateOption.classList.add('off');
            e.stopPropagation();
        });
    });

    document.getElementById('stateAllBtn')?.addEventListener('click', (e) => {
        selectedState = '';
        stateValue.textContent = '전체';
        stateOption.classList.add('off');
        e.stopPropagation();
    });

    document.addEventListener('click', () => {
        stateOption?.classList.add('off');
        regionOption?.classList.add('off');
    });


    // ===== 모달 관련 변수 =====
    const marketModal = document.querySelector('[name="market-edit"]');
    let marketEditMode = false;
    const marketEditBtn = marketModal?.querySelector('.EditModal-Button.Edit');
    const marketEditableIds = ['market-name', 'market-region', 'market-location', 'market-state'];

    // state 값 → 한국어 레이블 변환
    const marketStateToLabel = { pending: '입점 대기', active: '운영 중', inactive: '운영 중단' };

    // 현재 시간을 'YYYY-MM-DD HH:MM:SS' 형식으로 반환
    function nowDatetime() {
        const d = new Date();
        const pad = n => String(n).padStart(2, '0');
        return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }

    // ===== 수정 버튼 클릭 → 모달 오픈 + 즉시 수정 모드 =====
    function openMarketModalWithEditMode(row) {
        document.getElementById('market-id').value = row.dataset.id || '';
        document.getElementById('market-name').value = row.dataset.name || '';
        document.getElementById('market-region').value = row.dataset.region || '';
        document.getElementById('market-location').value = row.dataset.location || '';
        const stateInput = document.getElementById('market-state');
        const stateVal = row.dataset.state || '';
        stateInput.dataset.actualValue = stateVal;
        stateInput.value = marketStateToLabel[stateVal] || stateVal;
        document.getElementById('market-createdAt').value = row.dataset.created || '';
        document.getElementById('market-updatedAt').value = nowDatetime();

        marketModal?.classList.remove('off');

        // 즉시 수정 모드 진입
        if (!marketEditMode) {
            marketEditMode = true;
            if (marketEditBtn) marketEditBtn.textContent = '수정 취소';
            marketEditableIds.forEach(id => {
                const input = document.getElementById(id);
                if (!input) return;
                input.disabled = false;
                const wrapper = input.closest('.EditModal-InputContent, .EditModal-SelectContent');
                if (wrapper) wrapper.classList.remove('disabled');
            });
        }
    }


    function closeMarketModal() {
        marketModal.classList.add('off');
        if (marketEditMode) {
            marketEditMode = false;
            if (marketEditBtn) marketEditBtn.textContent = '수정 하기';
            marketEditableIds.forEach(id => {
                const input = document.getElementById(id);
                if (!input) return;
                input.disabled = true;
                const wrapper = input.closest('.EditModal-InputContent, .EditModal-SelectContent');
                if (wrapper) wrapper.classList.add('disabled');
            });
        }
    }

    marketModal?.querySelector('.EditModal-CloseButton')?.addEventListener('click', closeMarketModal);
    marketModal?.addEventListener('click', (e) => {
        if (e.target === marketModal) closeMarketModal();
    });

    // ===== 수정 하기 버튼 (수정 모드 토글) =====
    marketEditBtn?.addEventListener('click', () => {
        marketEditMode = !marketEditMode;
        marketEditBtn.textContent = marketEditMode ? '수정 취소' : '수정 하기';

        marketEditableIds.forEach(id => {
            const input = document.getElementById(id);
            if (!input) return;
            input.disabled = !marketEditMode;
            const wrapper = input.closest('.EditModal-InputContent, .EditModal-SelectContent');
            if (wrapper) {
                wrapper.classList.toggle('disabled', !marketEditMode);
            }
        });
    });

    // ===== 모달 내 드롭다운 =====
    marketModal?.querySelectorAll('.EditModal-SelectContent').forEach(selectContent => {
        selectContent.addEventListener('click', (e) => {
            if (selectContent.classList.contains('disabled')) return;
            const list = selectContent.querySelector('.EditModal-SelectList');
            list?.classList.toggle('off');
            e.stopPropagation();
        });
    });

    document.addEventListener('click', () => {
        marketModal?.querySelectorAll('.EditModal-SelectList').forEach(list => list.classList.add('off'));
    });

    marketModal?.querySelectorAll('.EditModal-Option').forEach(option => {
        option.addEventListener('click', (e) => {
            const list = option.closest('.EditModal-SelectList');
            const input = list?.closest('.EditModal-SelectContent')?.querySelector('.EditModal-Input');
            if (input) {
                const actualValue = option.dataset.value || option.querySelector('p')?.textContent || '';
                input.dataset.actualValue = actualValue;
                input.value = option.querySelector('p')?.textContent || '';
            }
            list?.classList.add('off');
            e.stopPropagation();
        });
    });

</script>
<script src="/js/admin/event.js"></script>
<script>initEvents();</script>
</html>
